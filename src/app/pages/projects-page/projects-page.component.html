<div class="projects-page">
  <!-- Hero Section -->
  <section class="page-hero">
    <div class="hero-content">
      <h1 class="page-title">Our Projects</h1>
      <p class="page-subtitle">
        Explore our portfolio of exceptional construction and development projects.
        From residential complexes to commercial buildings, each project showcases our commitment to quality and innovation.
      </p>
    </div>
  </section>

  <!-- Projects Section -->
  <section class="projects-section">
    <div class="projects-container">
      <!-- Category Filter -->
      <div class="category-filter">
        @for (category of categories; track category.id) {
          <button 
            class="category-btn" 
            [class.active]="selectedCategory() === category.id"
            (click)="selectCategory(category.id)">
            {{ category.label }}
          </button>
        }
      </div>

      <!-- Loading State -->
      @if (isLoading()) {
        <div class="loading-state">
          <div class="loader"></div>
          <p>Loading projects...</p>
        </div>
      }

      <!-- Projects Grid -->
      @if (!isLoading()) {
        <div class="projects-grid">
          @for (project of filteredProjects; track project.id) {
            <div class="project-card" (click)="openGallery(project, $event)">
              <div class="project-image">
                <img [ngSrc]="project.image" [alt]="project.title" loading="lazy" decoding="async" fill>
                <div class="project-overlay">
                  <button class="view-btn">View Gallery</button>
                  @if (project.gallery && project.gallery.length > 0) {
                    <span class="image-count">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <circle cx="8.5" cy="8.5" r="1.5"></circle>
                        <polyline points="21 15 16 10 5 21"></polyline>
                      </svg>
                      {{ project.gallery.length }} Photos
                    </span>
                  }
                </div>
              </div>
              <div class="project-content">
                <div class="project-tags">
                  @for (tag of project.tags; track tag) {
                    <span class="tag">{{ tag }}</span>
                  }
                </div>
                <h3 class="project-title">
                  <span class="title-text">{{ project.title }}</span>
                  @if (project.stamp) {
                    <img class="title-stamp" src="/stamps/approved-stamp.PNG" alt="" aria-hidden="true">
                  }
                </h3>
                <p class="project-description">{{ project.description }}</p>
                @if (project.location || project.year) {
                  <div class="project-meta">
                    @if (project.location) {
                      <span class="meta-item">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                          <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        {{ project.location }}
                      </span>
                    }
                    @if (project.year) {
                      <span class="meta-item">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                          <line x1="16" y1="2" x2="16" y2="6"></line>
                          <line x1="8" y1="2" x2="8" y2="6"></line>
                          <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        {{ project.year }}
                      </span>
                    }
                  </div>
                }
              </div>
            </div>
          }
        </div>

        @if (filteredProjects.length === 0) {
          <div class="no-results">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            <h3>No projects found</h3>
            <p>No projects found in this category.</p>
          </div>
        }
      }
    </div>
  </section>

  <!-- Gallery Modal -->
  @if (selectedProject()) {
    <app-project-gallery 
      [project]="selectedProject()"
      [origin]="clickOrigin()"
      (close)="closeGallery()">
    </app-project-gallery>
  }
</div>
